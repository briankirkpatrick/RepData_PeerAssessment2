text(cex=.6, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45)
text(cex=.8, x=x-.5, y=-1.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.5, y=-1.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-0.0, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-0.0, labs, xpd=TRUE, srt=90)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-0.0, labs, xpd=FALSE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-4.25, y=-4.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-4.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-10.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n", main = "Economic impact of US Weather Events from 1996 - 2011")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-10.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n", yaxt = "n", main = "Economic impact of US Weather Events from 1996 - 2011")
labs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-10.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n", yaxt = "n", main = "Economic impact of US Weather Events from 1996 - 2011")
xlabs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-10.25, labs, xpd=TRUE, srt=45)
ylabs <- axis(2, axTicks(2), format(axTicks(2), scientific = F)
)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n", yaxt = "n", main = "Economic impact of US Weather Events from 1996 - 2011")
xlabs <- paste(names(damagetable))
ylabs <- axis(2, axTicks(2), format(axTicks(2), scientific = F, srt = 90)
text(cex=.8, x=x-.25, y=-10.25, labs, xpd=TRUE, srt=45)
damagetable <- xtabs(impactdamage$damage ~ impactdamage$noaaeventtypes)
x <- barplot(damagetable, xaxt = "n", main = "Economic impact of US Weather Events from 1996 - 2011")
xlabs <- paste(names(damagetable))
text(cex=.8, x=x-.25, y=-10.25, labs, xpd=TRUE, srt=45)
g <- ggplot(impactdamage, aes(noaaeventtypes))
g
g <- ggplot(impactdamage, aes(damage))
g <- ggplot(impactdamage, aes(damage))
g <- g + geom_bar(colour = "darkblue")
g
g <- ggplot(impactdamage, aes(noaaeventttypes))
g <- g + geom_bar(colour = "darkblue")
g
g <- ggplot(impactdamage, aes(noaaeventtypes))
g <- g + geom_bar(colour = "darkblue")
g
g <- ggplot(impactdamage, aes(noaaeventtypes, damage))
g <- g + geom_bar(colour = "darkblue")
g
g <- ggplot(impactdamage, aes(noaaeventtypes))
g <- g + geom_bar(colour = "darkblue", weight = "damage")
g
g <- ggplot(impactdamage, aes(noaaeventtypes, weight = "damage"))
g <- g + geom_bar(colour = "darkblue")
g
g <- ggplot(impactdamage, aes(x = sum(damage), y = noaaeventtypes))
g <- g + geom_bar(colour = "darkblue")
g
g <- ggplot(impactdamage, aes(x = damage, y = noaaeventtypes))
g <- g + geom_bar(aes(weight = "damage"), colour = "darkblue")
g
g <- ggplot(impactdamage, aes(noaaeventtypes))
g <- g + geom_bar(aes(weight = "damage"), colour = "darkblue")
g
g <- ggplot(impactdamage, aes(x = damage, y = noaaeventtypes))
g <- g + geom_bar(colour = "darkblue")
g
g <- ggplot(impactdamage, aes(x = damage, y = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g
g <- ggplot(impactdamage, aes(x = factor(damage), y = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g
g <- ggplot(impactdamage, aes(y = factor(damage), x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g
qplot(impactdamage, geom="bar", stat="identity")
qplot(cut, impactdamage, geom="bar", stat="identity")
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold"))
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold"))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1)
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold"))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1)
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold"))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1))
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold"))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type", size = 20, face = "bold")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold"))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = "24")
g <- g + theme(axis.title = element_text(face = "bold", size = "20")
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold")
g <- g + theme(axis.title = element_text(face = "bold")
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold"))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 16))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g
library(scales)
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 16))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + scale_y_continuous(labels = comma)
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 16))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g <- g + theme(axis.text.y = element_text(size = 14))
g <- g + scale_y_continuous(labels = comma)
g
```{r}
g <- ggplot(impacthealth, aes(y = healthevents, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Number of Fatalies and Injuries Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 16))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g <- g + theme(axis.text.y = element_text(size = 14))
g <- g + scale_y_continuous(labels = comma)
g
```
```{r}
g <- ggplot(impacthealth, aes(y = healthevents, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Number of Fatalies and Injuries Caused by Event")
g <- g + labs(title = "Human Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 16))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g <- g + theme(axis.text.y = element_text(size = 14))
g <- g + scale_y_continuous(labels = comma)
g
```
```{r}
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 16))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g <- g + theme(axis.text.y = element_text(size = 14))
g <- g + scale_y_continuous(labels = comma)
g
```
library(xtable)
```{r}
xdamage <- xtable(summary(impactdamage))
print(xdamage, type = html)
```
names(impactdamage)
xdamage <- xtable(impactdamage)
print(xdamage, type = html)
```{r, fig.width = 10, fig.height= 5}
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 16))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
g <- g + theme(axis.text.y = element_text(size = 14))
g <- g + scale_y_continuous(labels = comma)
g
```
xhealth <- xtable(impacthealth)
print(xhealth, type = "html"")
xhealth <- xtable(impacthealth)
print(xhealth, type = "html")
```{r}
events <- read.csv("./data/StormData.csv.bz2")
```
#####Cleaning the Data
After reading the documentation provided at - http://www.ncdc.noaa.gov/stormevents/details.jsp - it was determined that the data prior to 1996 was not comprehensive enough for the purposes of identify the most costly weather events. All data prior to 1996 consists of only Tornado, Thunderstorm Wind and Hail events prior to recording all 48 weather events that are currnetly listed in the data dictionary for the database (found here https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf).
Given the above information the first step in processing the data was to get the date variables into date format and subset the data to data beginning in 1996.
```{r}
#create copy of data and create year objects of the date variables
events2 <- events
events2$BGN_DATE <- as.Date(events2$BGN_DATE, format = "%m/%d/%Y %H:%M:%S")
events2$END_DATE <- as.Date(events2$END_DATE, format = "%m/%d/%Y %H:%M:%S")
events2$bgn.year <- as.numeric(format(events2$BGN_DATE, "%Y"))
events2$end.year <- as.numeric(format(events2$END_DATE, "%Y"))
#subset to data collections beginning in 1996
events2 <- events2[events2$bgn.year >= 1996, ]
```
The data for property and crop damage was provided in two fields; an amount and a multiplier. Using the guidelines prodived in the data dictionary the multipliers were converted from symbols to numbers and new damage fields were created to show the whole dollar amounts of damages.
```{r}
#convert multipliers
events2$PROPDMGEXP <- gsub("0", "", events2$PROPDMGEXP)
events2$PROPDMGEXP <- gsub("K", 1000, events2$PROPDMGEXP)
events2$PROPDMGEXP <- gsub("B", 1000000000, events2$PROPDMGEXP)
events2$PROPDMGEXP <- gsub("M", 1000000, events2$PROPDMGEXP)
events2$CROPDMGEXP <- gsub("k|K", 1000, events2$CROPDMGEXP)
events2$CROPDMGEXP <- gsub("B", 1000000000, events2$CROPDMGEXP)
events2$CROPDMGEXP <- gsub("M", 1000000, events2$CROPDMGEXP)
#create damage fields
events2$propertydmg <- as.integer(events2$PROPDMG) * as.integer(events2$PROPDMGEXP)
events2$cropdmg <- as.integer(events2$CROPDMG) * as.integer(events2$CROPDMGEXP)
```
For the purposes of this initial analysis, there were a number of fields that were unnecessary and were removed in order to speed up processing time.
```{r}
#eliminate unnecessary columns of data
eventimpacts <- events2[ , c("BGN_DATE", "EVTYPE", "FATALITIES", "INJURIES", "propertydmg", "cropdmg", "REMARKS", "REFNUM", "bgn.year", "end.year")]
#clean up variable names
names(eventimpacts) <- c("bgndate", "eventtype", "fatalities", "injuries", "propertydmg", "cropdmg", "remarks", "referencenum", "bgnyear", "endyear" )
```
After reviewing the reduced data sets, it was clear that there were fare more event type names than corresponded with the names descriped in the data dictionary and these often include slightly different wordings, spelling errors or more specific detail than followed the guidelines.
A number of steps were taken based on reviewing the names and those are detailed as follows.
```{r}
#eliminate case differences
eventimpacts$eventtypeclean <- as.factor(tolower(eventimpacts$eventtype))
#eliminate common abbreviations
eventimpacts$eventtypeclean <- as.factor(gsub("tstm", "thunderstorm", eventimpacts$eventtypeclean))
```
After these initial steps, it was decided that the data could be reduced by removing any event types that had $0 damages to property/crops AND 0 injuries or fatalities.
```{r}
#create a summary of all property and crop damage by event type
eventdamage <- ddply(eventimpacts, .(eventtypeclean), summarize, damage = sum(as.numeric(propertydmg), as.numeric(cropdmg), na.rm = TRUE))
#create a summary of all injuries and fatalities by event type
eventhealth <- ddply(eventimpacts, .(eventtypeclean), summarize, healthevents = sum(as.numeric(fatalities), as.numeric(injuries), na.rm = TRUE))
#create a combined data set of health events and damages by event type
eventsummary <- merge(eventdamage, eventhealth, by.x = "eventtypeclean", by.y = "eventtypeclean", all = TRUE)
#create a reduced data set with only events that had damages and/or health events.
impactevents <- eventsummary[eventsummary$damage > 0 | eventsummary$healthevents > 0, ]
impacteventslist <- as.list(as.character(impactevents$eventtypeclean))
impactdata <- eventimpacts[eventimpacts$eventtypeclean %in% impacteventslist, ]
impactdata$eventtype <- factor(impactdata$eventtype)
impactdata$eventtypeclean <- factor(impactdata$eventtypeclean)
```
At this point, it became clear that there would not be a uniform way of reducing the remaining 183 event types down to the core 48. The 183 event types were downloaded into a csv file (which can be found in the linked github repo) where judgement calls were made on which of the core 48 event types the remaining 183 should be labeled under. This index was then loaded into R and a new variable was created to house the "noaaeventtypes".
```{r}
#upload the index for name consolidation to the 48 recommended storm listings
noaatypes <- read.csv("impactEventsListConversion.csv", header = TRUE, row.names = NULL)
noaatypes <- noaatypes[ , 2:3]
#create the new noaa event type variable
list1 <- as.vector(as.character(noaatypes[ , 1]))
list2 <- as.vector(as.character(noaatypes[ , 2]))
list3 <- as.vector(as.character(impactdata$eventtypeclean))
list4 <- mapvalues(list3, list1, list2, warn_missing = TRUE)
impactdata$noaaeventtypes <- list4
impactdata$noaaeventtypes <- factor(impactdata$noaaeventtypes)
```
With the data reduced to the core event types,  the final summary datasets for damages and health events were created.
```{r}
#create new damage and health summaries
impactdamage <- ddply(impactdata, .(noaaeventtypes), summarize, damage = sum(as.numeric(propertydmg), as.numeric(cropdmg), na.rm = TRUE))
impactdamage <- impactdamage[order(-impactdamage$damage), ]
impacthealth <- ddply(impactdata, .(noaaeventtypes), summarize, healthevents = sum(as.numeric(fatalities), as.numeric(injuries), na.rm = TRUE))
```
g <- ggplot(impacthealth, aes(y = healthevents, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Number of Fatalies and Injuries Caused by Event")
g <- g + labs(title = "Human Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = "billions")
g
g <- ggplot(impacthealth, aes(y = healthevents, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Number of Fatalies and Injuries Caused by Event")
g <- g + labs(title = "Human Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma, breaks = millions)
g
g <- ggplot(impacthealth, aes(y = healthevents, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Number of Fatalies and Injuries Caused by Event")
g <- g + labs(title = "Human Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma)
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(breaks = "billions")
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(breaks = billions)
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma, breaks = billions)
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma, breaks = "billions")
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma)
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma, labels = "millions")
g
g <- ggplot(impactdamage, aes(y = damage, x = noaaeventtypes))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Dollars of Damage Caused by Event")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = "millions")
g
xdamage <- xtable(impactdamage)
print(xdamage, type = "html")
xdamage <- xtable(impactdamage)
print(xdamage)
```{r showtable, results = "asis"}
xhealth <- xtable(impacthealth)
print(xhealth, type = "html")
```
View(impactevents)
g <- ggplot(impactdamage, aes(x = reorder(noaaeventtypes, damage),  y = damage))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + coord_flip()
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Monetary Damage Caused by Event (in USD $)")
g <- g + labs(title = "Economic Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma)
g
g <- ggplot(impacthealth, aes(x = reorder(noaaeventtypes, healthevents),  y = healthevents))
g <- g + geom_bar(stat = "identity", colour = "darkblue")
g <- g + coord_flip()
g <- g + labs(x = "Storm Event Type")
g <- g + labs(y = "Number of Fatalies and Injuries Caused by Event")
g <- g + labs(title = "Human Impact of US Storm Events from 1996 - 2011")
g <- g + theme(plot.title = element_text(face = "bold", size = 20))
g <- g + theme(axis.title = element_text(face = "bold", size = 14))
g <- g + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 12))
g <- g + theme(axis.text.y = element_text(size = 12))
g <- g + scale_y_continuous(labels = comma)
g
impacthealth <- impacthealth[order(-impacthealth$healthevents), ]
library("knitr", lib.loc="~/R/win-library/3.1")
.Rprofile()
touh ~/.Rprofile
touch ~/.Rprofile
